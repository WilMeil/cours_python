import random

def charger_mots_de_passe(fichier):
    try:
        with open(fichier, 'r') as f:
            return [ligne.strip() for ligne in f if ligne.strip()]
    except FileNotFoundError:
        print("Fichier introuvable. Utilisation de la liste par dÃ©faut.")
        return ["123456", "password", "admin", "123456789", "qwerty",
                "abc123", "letmein", "welcome", "monkey", "football"]

def lettres_communes(mot1, mot2):
    return len(set(mot1) & set(mot2))

def crackme():
    mots_de_passe_faibles = charger_mots_de_passe("mots_de_passe.txt")
    mot_secret = random.choice(mots_de_passe_faibles)
    historique = []

    print("ğŸ” Bienvenue dans CrackMe â€“ Trouve le mot de passe faible !")
    
    while True:
        try:
            limite = int(input("Combien d'essais maximum veux-tu ? (entier > 0) : "))
            if limite > 0:
                break
        except ValueError:
            pass
        print("â›” EntrÃ©e invalide. RÃ©essaye.")

    print("Tape 'triche' pour rÃ©vÃ©ler le mot de passe (Ã  des fins de test).\n")

    essais = 0
    trouve = False

    while essais < limite:
        tentative = input(f"Essai {essais + 1}/{limite} : ")

        if tentative.lower() == "triche":
            print(f"ğŸ¤« Mot de passe : {mot_secret}")
            continue

        historique.append(tentative)
        essais += 1

        if tentative == mot_secret:
            trouve = True
            print(f"\nâœ… Bravo ! Mot de passe trouvÃ© en {essais} essais.")
            break
        else:
            print("âŒ Mauvais mot de passe.")
            # Fournir un indice :
            if len(tentative) > len(mot_secret):
                print("ğŸ“ Indice : Le mot de passe est plus court.")
            elif len(tentative) < len(mot_secret):
                print("ğŸ“ Indice : Le mot de passe est plus long.")
            if tentative and tentative[0] == mot_secret[0]:
                print("ğŸ”¤ Indice : Il commence par la mÃªme lettre.")
            print(f"ğŸ” Lettres communes : {lettres_communes(tentative, mot_secret)}\n")

    if not trouve:
        print(f"\nğŸ’¥ Tu as Ã©chouÃ©. Le mot de passe Ã©tait : {mot_secret}")

    print("\nğŸ“ Historique de tes tentatives :")
    for i, mot in enumerate(historique, 1):
        print(f"{i}. {mot}")

if __name__ == "__main__":
    crackme()
